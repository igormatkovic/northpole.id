server {
  listen ${PORT};
  server_name _;

  root /app;
  index index.php;

  # ðŸ‘‡ This section handles clean URLs like /record/NP-0000001
  location / {
    # if the requested file exists, serve it; otherwise, rewrite
    try_files $uri $uri/ @rewrite;
  }

  location @rewrite {
    rewrite ^/record/([^/]+)/?$ /show.php?id=$1 last;
  }

  # ðŸ‘‡ PHP handling
  location ~ \.php$ {
    include fastcgi_params;
    fastcgi_param SCRIPT_FILENAME $realpath_root$fastcgi_script_name;
    fastcgi_param QUERY_STRING $query_string;
    fastcgi_pass 127.0.0.1:9000;
  }

  # Optional: deny access to hidden files
  location ~ /\. {
    deny all;
  }
}
